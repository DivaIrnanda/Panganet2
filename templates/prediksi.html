<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>PANGANET - Prediksi Ketahanan Pangan</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta
      content="ketahanan pangan, artificial intelligence, food security, Indonesia"
      name="keywords"
    />
    <meta
      content="PANGANET: Sistem Prediksi Ketahanan Pangan berbasis AI"
      name="description"
    />

    <!-- Favicon -->
    <link href="{{ url_for('static', filename='favicon.ico') }}" rel="icon" />

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600&family=Nunito:wght@600;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- Icon Font Stylesheet -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Libraries Stylesheet -->

    <link
      href="{{ url_for('static', filename='lib/animate/animate.min.css') }}"
      rel="stylesheet"
    />
    <link
      href="{{ url_for('static', filename='lib/owlcarousel/assets/owl.carousel.min.css') }}"
      rel="stylesheet"
    />

    <!-- Customized Bootstrap Stylesheet -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/bootstrap.min.css') }}"
    />

    <!-- Template Stylesheet -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />

    <style>
      /* Mobile-First Responsive Design */

      /* Hero Section Carousel Fix */
      .header-carousel .owl-carousel-item {
        position: relative;
        height: 100vh;
        min-height: 500px;
        overflow: hidden;
      }

      .header-carousel .owl-carousel-item img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 1;
      }

      .header-carousel .position-absolute {
        z-index: 2;
      }

      .owl-carousel .owl-stage-outer {
        overflow: hidden;
      }

      .container-fluid.p-0.mb-5 {
        overflow: hidden;
      }

      /* Mobile-Responsive Form Styles */
      .prediction-form {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 20px;
        padding: 1.5rem;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        margin: 0 15px;
      }

      /* Tablet and Desktop */
      @media (min-width: 768px) {
        .prediction-form {
          padding: 2rem;
          margin: 0;
        }
      }

      .form-floating {
        margin-bottom: 1rem;
      }

      .form-control {
        border: none;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        font-size: 16px; /* Prevents zoom on iOS */
      }

      /* Mobile input improvements */
      @media (max-width: 767px) {
        .form-control {
          padding: 0.75rem;
          font-size: 16px;
        }

        .form-floating > label {
          padding: 0.75rem;
        }
      }

      .form-control:focus {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        transform: translateY(-2px);
      }

      .btn-predict {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 25px;
        padding: 12px 30px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        width: 100%;
        max-width: 400px;
      }

      /* Desktop button */
      @media (min-width: 768px) {
        .btn-predict {
          padding: 12px 40px;
          width: auto;
        }
      }

      .btn-predict:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      /* Mobile-responsive result card */
      .result-card {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        border-radius: 20px;
        padding: 1.5rem;
        color: white;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.5s ease;
        display: none;
        margin: 0 15px;
      }

      @media (min-width: 768px) {
        .result-card {
          padding: 2rem;
          margin: 0;
        }
      }

      .result-card.show {
        opacity: 1;
        transform: translateY(0);
        display: block;
      }

      .feature-info {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
        backdrop-filter: blur(10px);
        text-align: center;
      }

      /* Mobile adjustments for feature info */
      @media (max-width: 576px) {
        .feature-info {
          padding: 0.75rem;
          margin-bottom: 0.75rem;
        }

        .feature-info h5 {
          font-size: 0.9rem;
          margin-bottom: 0.5rem;
        }

        .feature-info h2,
        .feature-info h4 {
          font-size: 1.2rem;
        }
      }

      .loading-spinner {
        display: none;
      }

      .loading-spinner.show {
        display: inline-block;
      }

      .tooltip-info {
        position: relative;
        cursor: help;
      }

      .tooltip-info:hover::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: #333;
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 12px;
        white-space: nowrap;
        z-index: 1000;
      }

      .status-good {
        color: #28a745 !important;
      }
      .status-warning {
        color: #ffc107 !important;
      }
      .status-danger {
        color: #dc3545 !important;
      }

      /* Mobile Navigation Improvements */
      @media (max-width: 991px) {
        .navbar-brand h2 {
          font-size: 1.5rem;
        }

        .navbar-nav .nav-link {
          padding: 10px 20px;
        }
      }

      /* Mobile Header Improvements */
      @media (max-width: 767px) {
        .page-header h1 {
          font-size: 2rem !important;
        }

        .page-header {
          padding: 3rem 0 !important;
        }

        .breadcrumb-item {
          font-size: 0.9rem;
        }
      }

      /* Mobile Text Improvements */
      @media (max-width: 576px) {
        .section-title {
          font-size: 0.9rem;
        }

        .mb-5 h1 {
          font-size: 1.8rem;
        }

        .lead {
          font-size: 1rem;
        }
      }

  

      /* Footer mobile improvements */
      @media (max-width: 767px) {
        .footer .col-lg-4 {
          margin-bottom: 2rem;
        }

        .footer h4 {
          font-size: 1.2rem;
        }

        .footer p {
          font-size: 0.9rem;
        }
      }

      /* Prevent horizontal scroll on mobile */
      body {
        overflow-x: hidden;
      }

      .container-xxl,
      .container-fluid {
        padding-left: 15px;
        padding-right: 15px;
      }

      @media (max-width: 575px) {
        .g-5 {
          --bs-gutter-x: 1rem;
        }

        .row > * {
          padding-left: 0.5rem;
          padding-right: 0.5rem;
        }
      }

      /* Touch-friendly buttons */
      @media (max-width: 767px) {
        .btn {
          min-height: 44px;
          padding: 12px 20px;
        }

        .back-to-top {
          width: 50px;
          height: 50px;
          bottom: 20px;
          right: 20px;
        }
      }
    </style>
  </head>

  <body>
    <!-- Spinner Start -->
    <div
      id="spinner"
      class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center"
    >
      <div
        class="spinner-border text-primary"
        style="width: 3rem; height: 3rem"
        role="status"
      >
        <span class="sr-only">Loading...</span>
      </div>
    </div>
    <!-- Spinner End -->

    <!-- Navbar Start -->
    <nav
      class="navbar navbar-expand-lg bg-white navbar-light shadow sticky-top p-0"
    >
      <a
        href="index.html"
        class="navbar-brand d-flex align-items-center px-4 px-lg-5"
      >
        <h2 class="m-0 text-primary">
          <i class="fa fa-seedling me-3"></i>PANGANET
        </h2>
      </a>
      <button
        type="button"
        class="navbar-toggler me-4"
        data-bs-toggle="collapse"
        data-bs-target="#navbarCollapse"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <div class="navbar-nav ms-auto p-4 p-lg-0">
          <a href="/" class="nav-item nav-link">Beranda</a>
          <a href="/#about" class="nav-item nav-link">Tentang</a>
          <a href="/#analysis" class="nav-item nav-link">Analisis</a>
          <a href="#" class="nav-item nav-link active">Prediksi</a>
        </div>
      </div>
    </nav>
    <!-- Navbar End -->

    <!-- Header Start -->
    <div class="container-fluid bg-primary py-5 mb-5 page-header">
      <div class="container py-5">
        <div class="row justify-content-center">
          <div class="col-lg-10 text-center">
            <h1 class="display-3 text-white animated slideInDown">
              Prediksi Ketahanan Pangan
            </h1>
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb justify-content-center">
                <li class="breadcrumb-item">
                  <a class="text-white" href="index.html">Beranda</a>
                </li>
                <li
                  class="breadcrumb-item text-white active"
                  aria-current="page"
                >
                  Prediksi
                </li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <!-- Header End -->

    <!-- Prediction Form Start -->
    <div class="container-xxl py-5">
      <div class="container">
        <div class="text-center wow fadeInUp" data-wow-delay="0.1s">
          <h6 class="section-title bg-white text-center text-primary px-3">
            AI Prediction
          </h6>
          <h1 class="mb-5">Masukkan Data Wilayah</h1>
          <p class="mb-4">
            Sistem akan menganalisis 9 indikator utama untuk memprediksi tingkat
            ketahanan pangan wilayah
          </p>
        </div>

        <div class="row g-5 justify-content-center">
          <div class="col-lg-8">
            <div class="prediction-form wow fadeInUp" data-wow-delay="0.3s">
              <form id="predictionForm">
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur1"
                        name="fitur1"
                        placeholder="Fitur 1"
                        required
                      />
                      <label for="fitur1">NCPR</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur2"
                        name="fitur2"
                        placeholder="Fitur 2"
                        required
                      />
                      <label for="fitur2">Kemiskinan %</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur3"
                        name="fitur3"
                        placeholder="Fitur 3"
                        required
                      />
                      <label for="fitur3">Tanpa Pangan %</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur4"
                        name="fitur4"
                        placeholder="Fitur 4"
                        required
                      />
                      <label for="fitur4">Tanpa Listrik %</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur5"
                        name="fitur5"
                        placeholder="Fitur 5"
                        required
                      />
                      <label for="fitur5">Tanpa Air Bersih %</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur6"
                        name="fitur6"
                        placeholder="Fitur 6"
                        required
                      />
                      <label for="fitur6">Lama Sekolah Wanita (Tahun)</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur7"
                        name="fitur7"
                        placeholder="Fitur 7"
                        required
                      />
                      <label for="fitur7">Rasio Tenaga Kesehatan</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur8"
                        name="fitur8"
                        placeholder="Fitur 8"
                        required
                      />
                      <label for="fitur8">Angka Harapan Hidup</label>
                    </div>
                  </div>

                  <div class="col-12">
                    <div class="form-floating">
                      <input
                        type="number"
                        step="0.01"
                        class="form-control"
                        id="fitur9"
                        name="fitur9"
                        placeholder="Fitur 9"
                        required
                      />
                      <label for="fitur9">Stunting %</label>
                    </div>
                  </div>
                </div>

                <div class="text-center mt-4">
                  <button type="submit" class="btn btn-primary btn-predict">
                    <span
                      class="loading-spinner spinner-border spinner-border-sm me-2"
                      role="status"
                    ></span>
                    <i class="fa fa-calculator me-2"></i>Prediksi Ketahanan
                    Pangan
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Result Section -->
        <div id="resultSection" class="row g-5 justify-content-center mt-5">
          <div class="col-lg-8">
            <div id="resultCard" class="result-card">
              <div class="text-center">
                <i class="fa fa-chart-line fa-3x mb-4"></i>
                <h3 class="mb-4">Hasil Prediksi Ketahanan Pangan</h3>
                <div class="row g-4">
                  <div class="col-md-4">
                    <div class="feature-info">
                      <h5>Indeks Ketahanan Pangan</h5>
                      <h2 id="ikpResult" class="text-warning">-</h2>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="feature-info">
                      <h5>Kategori Wilayah</h5>
                      <h4 id="categoryResult" class="text-warning">-</h4>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="feature-info">
                      <h5>Status Ketahanan</h5>
                      <h4 id="statusResult" class="text-warning">-</h4>
                    </div>
                  </div>
                </div>
                <div class="mt-4">
                  <h5>Rekomendasi Kebijakan</h5>
                  <p id="recommendationResult" class="lead">-</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Prediction Form End -->

    <!-- Footer Start -->
    <div
      class="container-fluid bg-dark text-light footer pt-5 mt-5 wow fadeIn"
      data-wow-delay="0.1s"
    >
      <div class="container py-5">
        <div class="row g-5">
          <div class="col-lg-4 col-md-6">
            <h4 class="text-white mb-3">PANGANET</h4>
            <p class="mb-4">
              Sistem Analisis berbasis Artificial Intelligence untuk Mewujudkan
              Ketahanan Pangan Nasional yang Inklusif
            </p>
            
          </div>
          <div class="col-lg-4 col-md-6">
            <h4 class="text-white mb-3">Kontak</h4>
            <p class="mb-2">
              <i class="fa fa-university me-3"></i>Universitas Dian Nuswantoro
            </p>
            <p class="mb-2">
              <i class="fa fa-map-marker-alt me-3"></i>Jl. Nakula I No.5-11,
              Pendrikan Kidul, Kec. Semarang Tengah, Kota Semarang, Jawa Tengah
              50131
            </p>
            <p class="mb-2">
              <i class="fa fa-phone-alt me-3"></i>+62 812-1626-2867
            </p>
          </div>
          <div class="col-lg-4 col-md-6">
            <h4 class="text-white mb-3">Lokasi Kampus</h4>
            <div class="map-container">
              <iframe
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d9745.349058894997!2d110.41192650975756!3d-6.98772583447143!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e708b4ec52229d7%3A0xc791d6abc9236c7!2sUniversitas%20Dian%20Nuswantoro!5e0!3m2!1sid!2sid!4v1757682063833!5m2!1sid!2sid"
                width="600"
                height="450"
                style="border: 0"
                allowfullscreen=""
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"
              ></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"
      ><i class="bi bi-arrow-up"></i
    ></a>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='lib/wow/wow.min.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/easing/easing.min.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/waypoints/waypoints.min.js') }}"></script>
    

    <script>
      // Hide spinner after page load
      window.addEventListener("load", function () {
        setTimeout(function () {
          var spinner = document.getElementById("spinner");
          if (spinner) {
            spinner.classList.remove("show");
          }
        }, 500);
      });

      // Function to determine food security category and recommendations
      function getFoodSecurityCategory(ikp) {
        if (ikp >= 80) {
          return {
            category: "Klaster 2 - Transisi",
            status: "Cukup Stabil",
            statusClass: "status-warning",
            recommendation:
              "Fokus pada perbaikan akses air bersih, layanan kesehatan, serta distribusi pangan agar wilayah lebih tahan pangan.",
          };
        } else if (ikp >= 70) {
          return {
            category: "Klaster 1 - Stabil Pangan",
            status: "Tahan Pangan",
            statusClass: "status-good",
            recommendation:
              "Pertahankan kondisi baik, kembangkan inovasi teknologi pangan, dan lakukan diversifikasi produk untuk menjaga ketahanan jangka panjang.",
          };
        } else {
          return {
            category: "Klaster 3 - Rentan Pangan",
            status: "Perlu Perhatian",
            statusClass: "status-danger",
            recommendation:
              "Prioritaskan pengentasan kemiskinan, perluasan akses air bersih, listrik, serta perbaikan layanan kesehatan dan gizi.",
          };
        }
      }

      // Prediction form handler
      document
        .getElementById("predictionForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          // Show loading spinner
          const spinner = document.querySelector(".loading-spinner");
          const button = document.querySelector(".btn-predict");
          spinner.classList.add("show");
          button.disabled = true;

          // Collect input data
          const data = {
            fitur1: parseFloat(document.getElementById("fitur1").value),
            fitur2: parseFloat(document.getElementById("fitur2").value),
            fitur3: parseFloat(document.getElementById("fitur3").value),
            fitur4: parseFloat(document.getElementById("fitur4").value),
            fitur5: parseFloat(document.getElementById("fitur5").value),
            fitur6: parseFloat(document.getElementById("fitur6").value),
            fitur7: parseFloat(document.getElementById("fitur7").value),
            fitur8: parseFloat(document.getElementById("fitur8").value),
            fitur9: parseFloat(document.getElementById("fitur9").value),
          };

          try {
            const response = await fetch("/predict", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(data),
            });

            const result = await response.json();

            if (result.prediction !== undefined) {
              const ikp = result.prediction;
              const categoryInfo = getFoodSecurityCategory(ikp);

              // Update result display
              document.getElementById("ikpResult").textContent = ikp.toFixed(2);
              document.getElementById("categoryResult").textContent =
                categoryInfo.category;
              document.getElementById("statusResult").textContent =
                categoryInfo.status;
              document.getElementById(
                "statusResult"
              ).className = `text-white ${categoryInfo.statusClass}`;
              document.getElementById("recommendationResult").textContent =
                categoryInfo.recommendation;

              // Show result card with animation
              const resultCard = document.getElementById("resultCard");
              resultCard.classList.add("show");

              // Scroll to result
              resultCard.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
            } else {
              alert(
                "Error: " + (result.error || "Terjadi kesalahan dalam prediksi")
              );
            }
          } catch (err) {
            alert("Terjadi kesalahan koneksi: " + err.message);
          } finally {
            // Hide loading spinner
            spinner.classList.remove("show");
            button.disabled = false;
          }
        });

      // Smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute("href"));
          if (target) {
            target.scrollIntoView({
              behavior: "smooth",
              block: "start",
            });
          }
        });
      });

      // Back to top functionality
      window.addEventListener("scroll", function () {
        const backToTop = document.querySelector(".back-to-top");
        if (window.pageYOffset > 300) {
          backToTop.style.display = "block";
        } else {
          backToTop.style.display = "none";
        }
      });

      document
        .querySelector(".back-to-top")
        .addEventListener("click", function (e) {
          e.preventDefault();
          window.scrollTo({
            top: 0,
            behavior: "smooth",
          });
        });

      // Initialize WOW.js for animations if available
      if (typeof WOW !== "undefined") {
        new WOW().init();
      }
    </script>
  </body>
</html>
